(()=>{"use strict";function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var t=function(){function t(e){var n=e.baseUrl,r=e.headers;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this._baseUrl=n,this._headers=r}var n,r;return n=t,(r=[{key:"_processResponse",value:function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}},{key:"_get",value:function(e){return fetch("".concat(this._baseUrl).concat(e),{headers:this._headers}).then(this._processResponse)}},{key:"_getUserInfo",value:function(){return this._get("/users/me")}},{key:"_getInitialCards",value:function(){return this._get("/cards")}},{key:"getInitialData",value:function(){return Promise.all([this._getUserInfo(),this._getInitialCards()])}},{key:"updateUserInfo",value:function(e){var t=e.name,n=e.description;return fetch("".concat(this._baseUrl,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:n})}).then(this._processResponse)}},{key:"addCard",value:function(e){return fetch("".concat(this._baseUrl,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify(e)}).then(this._processResponse)}},{key:"deleteCard",value:function(e){return fetch("".concat(this._baseUrl,"/cards/").concat(e),{method:"DELETE",headers:this._headers}).then(this._processResponse)}},{key:"likeCard",value:function(e){return fetch("".concat(this._baseUrl,"/cards/").concat(e,"/likes"),{method:"PUT",headers:this._headers}).then(this._processResponse)}},{key:"removeLike",value:function(e){return fetch("".concat(this._baseUrl,"/cards/").concat(e,"/likes"),{method:"DELETE",headers:this._headers}).then(this._processResponse)}},{key:"updateAvatar",value:function(e){return fetch("".concat(this._baseUrl,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify(e)}).then(this._processResponse)}}])&&e(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}();function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var r=function(){function e(t,n){var r,o,i=this,a=t.data,u=t.handleCardClick,c=t.handleLikeClick,s=t.handleDeleteClick;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),o=function(){i._element.remove()},(r="remove")in this?Object.defineProperty(this,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):this[r]=o,this._cardData=a,this._templateSelector=n,this._handleCardClick=u,this._handleLikeClick=c,this._handleDeleteClick=s}var t,r;return t=e,(r=[{key:"_getTemplate",value:function(){return document.querySelector(this._templateSelector).content.querySelector(".gallery__item").cloneNode(!0)}},{key:"_setEventListeners",value:function(){var e=this;this._imageElement.addEventListener("click",(function(){return e._handleCardClick(e)})),this._element.querySelector(".button_type_like").addEventListener("click",(function(){return e._handleLikeClick(e)})),null!==this._deleteButton&&this._deleteButton.addEventListener("click",(function(){return e._handleDeleteClick(e)}))}},{key:"getName",value:function(){return this._cardData.name}},{key:"getLink",value:function(){return this._cardData.link}},{key:"getId",value:function(){return this._cardData._id}},{key:"isLiked",value:function(){var e=this;return this._cardData.likes.some((function(t){return t._id===e._cardData.currentUserId}))}},{key:"updateLikes",value:function(e){this._cardData.likes=e.likes,this._processLikes()}},{key:"_processLikes",value:function(){this.isLiked()?this._likeButton.classList.add("button_type_like-active"):this._likeButton.classList.remove("button_type_like-active"),this._likeCounter.textContent=this._cardData.likes.length}},{key:"generateCard",value:function(){return this._element=this._getTemplate(),this._imageElement=this._element.querySelector(".gallery__image"),this._deleteButton=this._element.querySelector(".button_type_trash"),this._likeButton=this._element.querySelector(".button_type_like"),this._likeCounter=this._element.querySelector(".gallery__like-counter"),this._cardData.owner._id!==this._cardData.currentUserId&&this._deleteButton.remove(),this._processLikes(),this._setEventListeners(),this._element.querySelector(".gallery__title").textContent=this.getName(),this._imageElement.alt=this.getName(),this._imageElement.src=this.getLink(),this._element}}])&&n(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var a=function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),i(this,"_disableSubmitButton",(function(){var e=r._params.inactiveButtonClass;r._submitButton.classList.add(e),r._submitButton.setAttribute("disabled",!0)})),i(this,"_enableSubmitButton",(function(){var e=r._params.inactiveButtonClass;r._submitButton.classList.remove(e),r._submitButton.removeAttribute("disabled")})),this._form=n,this._params=t,this._inputs=Array.from(n.querySelectorAll(t.inputSelector)),this._submitButton=n.querySelector(t.submitButtonSelector)}var t,n;return t=e,(n=[{key:"_hasInvalidInput",value:function(){return this._inputs.some((function(e){return!e.validity.valid}))}},{key:"_toggleSubmitButton",value:function(){this._hasInvalidInput()?this._disableSubmitButton():this._enableSubmitButton()}},{key:"_getErrorElement",value:function(e){return this._form.querySelector(".".concat(e.name,"-input-error"))}},{key:"_showInputError",value:function(e){var t=this._params,n=t.inputErrorClass,r=t.errorClass,o=this._getErrorElement(e);e.classList.add(n),o.textContent=e.validationMessage,o.classList.add(r)}},{key:"_hideInputError",value:function(e){var t=this._params,n=t.inputErrorClass,r=t.errorClass,o=this._getErrorElement(e);e.classList.remove(n),o.classList.remove(r),o.textContent=""}},{key:"_checkInputValidity",value:function(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}},{key:"_setEventListeners",value:function(){var e=this;this._inputs.forEach((function(t){t.addEventListener("input",(function(){e._checkInputValidity(t),e._toggleSubmitButton()}))}))}},{key:"resetValidation",value:function(){var e=this;this._inputs.forEach((function(t){return e._hideInputError(t)})),this._toggleSubmitButton()}},{key:"enableValidation",value:function(){this._form.addEventListener("submit",(function(e){return e.preventDefault()})),this._setEventListeners()}}])&&o(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var s=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),c(this,"_handleEscClose",(function(e){"Escape"===e.key&&n.close()})),c(this,"_handleClose",(function(e){(e.target===e.currentTarget||e.target.classList.contains("button_type_close"))&&n.close()})),this._element=document.querySelector(t)}var t,n;return t=e,(n=[{key:"setEventListeners",value:function(){this._element.addEventListener("click",this._handleClose)}},{key:"open",value:function(){this._element.classList.add("popup_opened"),document.addEventListener("keyup",this._handleEscClose)}},{key:"close",value:function(){this._element.classList.remove("popup_opened"),document.removeEventListener("keyup",this._handleEscClose)}}])&&u(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(){return p="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=y(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},p.apply(this,arguments)}function y(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_(e)););return e}function h(e,t){return h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},h(e,t)}function d(e,t){if(t&&("object"===l(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function _(e){return _=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},_(e)}var b=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=_(r);if(o){var n=_(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return d(this,e)});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e))._image=t._element.querySelector(".preview__image"),t._title=t._element.querySelector(".preview__title"),t}return t=a,(n=[{key:"open",value:function(e){var t=e.getName();this._title.textContent=t,this._image.alt=t,this._image.src=e.getLink(),p(_(a.prototype),"open",this).call(this)}}])&&f(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(s);function v(e){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},v(e)}function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){k(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function k(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function O(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function w(){return w="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=j(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},w.apply(this,arguments)}function j(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=P(e)););return e}function S(e,t){return S=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},S(e,t)}function E(e,t){if(t&&("object"===v(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function P(e){return P=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},P(e)}var C=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&S(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=P(r);if(o){var n=P(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return E(this,e)});function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this,e))._submit=t,n._form=n._element.querySelector(".popup__form"),n._inputs=Array.from(n._form.querySelectorAll(".popup__input")),n._submitButton=n._element.querySelector(".button_type_save"),n._submitButtonCaption=n._submitButton.textContent,n}return t=a,(n=[{key:"_getInputValues",value:function(){return this._inputs.reduce((function(e,t){var n=t.name,r=t.value;return g(g({},e),{},k({},n,r))}),{})}},{key:"renderLoading",value:function(e){this._submitButton.textContent=e?"Сохранение...":this._submitButtonCaption}},{key:"setEventListeners",value:function(){var e=this;w(P(a.prototype),"setEventListeners",this).call(this),this._element.addEventListener("submit",(function(t){t.preventDefault(),e._submit(e._getInputValues())}))}},{key:"close",value:function(){w(P(a.prototype),"close",this).call(this),this._form.reset()}}])&&O(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(s);function L(e){return L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},L(e)}function I(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function B(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function D(){return D="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=R(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},D.apply(this,arguments)}function R(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=U(e)););return e}function q(e,t){return q=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},q(e,t)}function T(e,t){if(t&&("object"===L(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function U(e){return U=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},U(e)}var A=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&q(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=U(r);if(o){var n=U(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return T(this,e)});function a(){return I(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"setAction",value:function(e){this._action=e}},{key:"setEventListeners",value:function(){var e=this;D(U(a.prototype),"setEventListeners",this).call(this),this._element.addEventListener("submit",(function(t){t.preventDefault(),e._action()}))}}])&&B(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(s);function x(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var V=function(){function e(t){var n=t.nameSelector,r=t.descriptionSelector,o=t.avatarSelector;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._id=null,this._name=document.querySelector(n),this._description=document.querySelector(r),this._avatar=document.querySelector(o)}var t,n;return t=e,(n=[{key:"getUserInfo",value:function(){return{name:this._name.textContent,description:this._description.textContent}}},{key:"setUserInfo",value:function(e){var t=e.name,n=e.about,r=e.avatar,o=e._id;this._id=o,this._name.textContent=t,this._description.textContent=n,this._avatar.style.backgroundImage="url(".concat(r,")")}}])&&x(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function N(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var J=function(){function e(t,n){var r=t.data,o=t.renderer;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._renderedItems=r,this._renderer=o,this._container=document.querySelector(n)}var t,n;return t=e,n=[{key:"addItem",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t?this._container.prepend(e):this._container.append(e)}},{key:"renderItems",value:function(){var e=this;this._renderedItems.forEach((function(t){e._renderer(t)}))}}],n&&N(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),H=document.forms.addCard,M=document.forms.userProfile,z=M.querySelector(".popup__input_property_name"),$=M.querySelector(".popup__input_property_description"),F=document.querySelector(".button_type_edit"),G=document.querySelector(".button_type_add"),K=document.querySelector(".profile__avatar"),Q=function(e){console.log(e)};function W(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function X(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?X(Object(n),!0).forEach((function(t){Z(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):X(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Z(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ee,te,ne,re=new t({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-41",headers:{authorization:"4e0acfe9-d71b-4358-91af-c8fd963442f5","Content-Type":"application/json"}}),oe={};te=(ee={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".button",inactiveButtonClass:"button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"}).formSelector,ne=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(ee,["formSelector"]),Array.from(document.querySelectorAll(te)).forEach((function(e){var t=new a(ne,e);t.enableValidation(),oe[e.getAttribute("name")]=t}));var ie=new V({nameSelector:".profile__title",descriptionSelector:".profile__description",avatarSelector:".profile__avatar"}),ae=new b(".popup_type_preview"),ue=new A(".popup_type_confirm"),ce=function(e){var t=new r({data:Y({currentUserId:ie._id},e),handleCardClick:function(){ae.open(t)},handleLikeClick:function(e){(e.isLiked()?re.removeLike(e.getId()):re.likeCard(e.getId())).then((function(t){e.updateLikes(t)})).catch(Q)},handleDeleteClick:function(e){ue.open(),ue.setAction((function(){re.deleteCard(e.getId()).then((function(){e.remove(),ue.close()})).catch(Q)}))}},"#gallery-item-template");return t.generateCard()},se=new J({data:[],renderer:function(e){var t=ce(e);se.addItem(t)}},".gallery");re.getInitialData().then((function(e){var t,n,r=(n=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,u=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){u=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(u)throw o}}return i}}(t,n)||function(e,t){if(e){if("string"==typeof e)return W(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?W(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=r[0],i=r[1];ie.setUserInfo(o),i.forEach((function(e){var t=ce(e);se.addItem(t,!1)}))})).catch(Q);var le=new C(".popup_type_add-card",(function(e){le.renderLoading(!0),re.addCard(e).then((function(e){var t=ce(e);se.addItem(t),le.close()})).catch(Q).finally((function(){le.renderLoading(!1)}))})),fe=new C(".popup_type_edit-profile",(function(e){fe.renderLoading(!0),re.updateUserInfo(e).then((function(e){ie.setUserInfo(e),fe.close()})).catch(Q).finally((function(){fe.renderLoading(!1)}))})),pe=new C(".popup_type_avatar",(function(e){pe.renderLoading(!0),re.updateAvatar(e).then((function(e){ie.setUserInfo(e),pe.close()})).catch(Q).finally((function(){pe.renderLoading(!1)}))}));[ae,le,fe,ue,pe].forEach((function(e){return e.setEventListeners()})),K.addEventListener("click",(function(){pe.open()})),G.addEventListener("click",(function(){oe[H.getAttribute("name")].resetValidation(),le.open()})),F.addEventListener("click",(function(){var e=ie.getUserInfo(),t=e.name,n=e.description;z.value=t,$.value=n,oe[M.getAttribute("name")].resetValidation(),fe.open()}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QixTQUFDK0UsR0FDM0RLLEdBQVlKLGVBQWMsR0FDMUJsQyxHQUNHdUMsYUFBYU4sR0FDYnBMLE1BQUssU0FBQ2UsR0FDTDJJLEdBQVN3QixZQUFZbkssR0FDckIwSyxHQUFZL0YsV0FFYjZFLE1BQU16QixHQUNOd0MsU0FBUSxXQUNQRyxHQUFZSixlQUFjLFNBR2hDLENBQUN6QixHQUFjdUIsR0FBV0ksR0FBYzFCLEdBQWM0QixJQUFhdEcsU0FBUSxTQUFDd0csR0FBRCxPQUN6RUEsRUFBTUMsdUJBR1IvQyxFQUFhN0csaUJBQWlCLFNBQVMsV0FDckN5SixHQUFZeEIsVUFFZHJCLEVBQWM1RyxpQkFBaUIsU0FBUyxXQUN0Q3NILEdBQWVsQixFQUFZcUIsYUFBYSxTQUFTb0Msa0JBQ2pEVixHQUFVbEIsVUFFWnRCLEVBQWtCM0csaUJBQWlCLFNBQVMsV0FDMUMsTUFBOEIwSCxHQUFTb0MsY0FBL0J4TCxFQUFSLEVBQVFBLEtBQU1DLEVBQWQsRUFBY0EsWUFDZGtJLEVBQVU5QixNQUFRckcsRUFDbEJvSSxFQUFpQi9CLE1BQVFwRyxFQUN6QitJLEdBQWVmLEVBQWdCa0IsYUFBYSxTQUFTb0Msa0JBQ3JETixHQUFhdEIsVyIsInNvdXJjZXMiOlsid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aFN1Ym1pdC5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvdXRpbHMvaGVscGVycy5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9wYWdlcy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBjbGFzcyB7XG4gIGNvbnN0cnVjdG9yKHsgYmFzZVVybCwgaGVhZGVycyB9KSB7XG4gICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XG4gICAgdGhpcy5faGVhZGVycyA9IGhlYWRlcnM7XG4gIH1cblxuICBfcHJvY2Vzc1Jlc3BvbnNlKHJlcykge1xuICAgIGlmIChyZXMub2spIHtcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgIH1cbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYNCe0YjQuNCx0LrQsDogJHtyZXMuc3RhdHVzfWApO1xuICB9XG5cbiAgX2dldChwYXRoKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9JHtwYXRofWAsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLl9wcm9jZXNzUmVzcG9uc2UpO1xuICB9XG5cbiAgX2dldFVzZXJJbmZvKCkge1xuICAgIHJldHVybiB0aGlzLl9nZXQoJy91c2Vycy9tZScpO1xuICB9XG5cbiAgX2dldEluaXRpYWxDYXJkcygpIHtcbiAgICByZXR1cm4gdGhpcy5fZ2V0KCcvY2FyZHMnKTtcbiAgfVxuXG4gIGdldEluaXRpYWxEYXRhKCkge1xuICAgIHJldHVybiBQcm9taXNlLmFsbChbdGhpcy5fZ2V0VXNlckluZm8oKSwgdGhpcy5fZ2V0SW5pdGlhbENhcmRzKCldKTtcbiAgfVxuXG4gIHVwZGF0ZVVzZXJJbmZvKHsgbmFtZSwgZGVzY3JpcHRpb24gfSkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgIG1ldGhvZDogJ1BBVENIJyxcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG5hbWUsXG4gICAgICAgIGFib3V0OiBkZXNjcmlwdGlvbixcbiAgICAgIH0pLFxuICAgIH0pLnRoZW4odGhpcy5fcHJvY2Vzc1Jlc3BvbnNlKTtcbiAgfVxuXG4gIGFkZENhcmQoY2FyZCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGNhcmQpLFxuICAgIH0pLnRoZW4odGhpcy5fcHJvY2Vzc1Jlc3BvbnNlKTtcbiAgfVxuXG4gIGRlbGV0ZUNhcmQoY2FyZElkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfWAsIHtcbiAgICAgIG1ldGhvZDogJ0RFTEVURScsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4odGhpcy5fcHJvY2Vzc1Jlc3BvbnNlKTtcbiAgfVxuXG4gIGxpa2VDYXJkKGNhcmRJZCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XG4gICAgICBtZXRob2Q6ICdQVVQnLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKHRoaXMuX3Byb2Nlc3NSZXNwb25zZSk7XG4gIH1cblxuICByZW1vdmVMaWtlKGNhcmRJZCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XG4gICAgICBtZXRob2Q6ICdERUxFVEUnLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKHRoaXMuX3Byb2Nlc3NSZXNwb25zZSk7XG4gIH1cblxuICB1cGRhdGVBdmF0YXIoZGF0YSkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XG4gICAgICBtZXRob2Q6ICdQQVRDSCcsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoZGF0YSksXG4gICAgfSkudGhlbih0aGlzLl9wcm9jZXNzUmVzcG9uc2UpO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyB7XG4gIGNvbnN0cnVjdG9yKHsgZGF0YSwgaGFuZGxlQ2FyZENsaWNrLCBoYW5kbGVMaWtlQ2xpY2ssIGhhbmRsZURlbGV0ZUNsaWNrIH0sIHRlbXBsYXRlU2VsZWN0b3IpIHtcbiAgICB0aGlzLl9jYXJkRGF0YSA9IGRhdGE7XG4gICAgdGhpcy5fdGVtcGxhdGVTZWxlY3RvciA9IHRlbXBsYXRlU2VsZWN0b3I7XG5cbiAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sgPSBoYW5kbGVDYXJkQ2xpY2s7XG4gICAgdGhpcy5faGFuZGxlTGlrZUNsaWNrID0gaGFuZGxlTGlrZUNsaWNrO1xuICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNsaWNrID0gaGFuZGxlRGVsZXRlQ2xpY2s7XG4gIH1cblxuICBfZ2V0VGVtcGxhdGUoKSB7XG4gICAgcmV0dXJuIGRvY3VtZW50XG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl90ZW1wbGF0ZVNlbGVjdG9yKVxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcignLmdhbGxlcnlfX2l0ZW0nKVxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9pbWFnZUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sodGhpcykpO1xuICAgIHRoaXMuX2VsZW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKCcuYnV0dG9uX3R5cGVfbGlrZScpXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB0aGlzLl9oYW5kbGVMaWtlQ2xpY2sodGhpcykpO1xuXG4gICAgaWYgKHRoaXMuX2RlbGV0ZUJ1dHRvbiAhPT0gbnVsbCkge1xuICAgICAgdGhpcy5fZGVsZXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gdGhpcy5faGFuZGxlRGVsZXRlQ2xpY2sodGhpcykpO1xuICAgIH1cbiAgfVxuXG4gIGdldE5hbWUoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2NhcmREYXRhLm5hbWU7XG4gIH1cblxuICBnZXRMaW5rKCkge1xuICAgIHJldHVybiB0aGlzLl9jYXJkRGF0YS5saW5rO1xuICB9XG5cbiAgZ2V0SWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2NhcmREYXRhLl9pZDtcbiAgfVxuXG4gIHJlbW92ZSA9ICgpID0+IHtcbiAgICB0aGlzLl9lbGVtZW50LnJlbW92ZSgpO1xuICB9O1xuXG4gIGlzTGlrZWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2NhcmREYXRhLmxpa2VzLnNvbWUoKHVzZXIpID0+IHVzZXIuX2lkID09PSB0aGlzLl9jYXJkRGF0YS5jdXJyZW50VXNlcklkKTtcbiAgfVxuXG4gIHVwZGF0ZUxpa2VzKGRhdGEpIHtcbiAgICB0aGlzLl9jYXJkRGF0YS5saWtlcyA9IGRhdGEubGlrZXM7XG4gICAgdGhpcy5fcHJvY2Vzc0xpa2VzKCk7XG4gIH1cblxuICBfcHJvY2Vzc0xpa2VzKCkge1xuICAgIGlmICh0aGlzLmlzTGlrZWQoKSkge1xuICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdidXR0b25fdHlwZV9saWtlLWFjdGl2ZScpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoJ2J1dHRvbl90eXBlX2xpa2UtYWN0aXZlJyk7XG4gICAgfVxuICAgIHRoaXMuX2xpa2VDb3VudGVyLnRleHRDb250ZW50ID0gdGhpcy5fY2FyZERhdGEubGlrZXMubGVuZ3RoO1xuICB9XG5cbiAgZ2VuZXJhdGVDYXJkKCkge1xuICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xuICAgIHRoaXMuX2ltYWdlRWxlbWVudCA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmdhbGxlcnlfX2ltYWdlJyk7XG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuYnV0dG9uX3R5cGVfdHJhc2gnKTtcbiAgICB0aGlzLl9saWtlQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuYnV0dG9uX3R5cGVfbGlrZScpO1xuICAgIHRoaXMuX2xpa2VDb3VudGVyID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZ2FsbGVyeV9fbGlrZS1jb3VudGVyJyk7XG5cbiAgICBpZiAodGhpcy5fY2FyZERhdGEub3duZXIuX2lkICE9PSB0aGlzLl9jYXJkRGF0YS5jdXJyZW50VXNlcklkKSB7XG4gICAgICB0aGlzLl9kZWxldGVCdXR0b24ucmVtb3ZlKCk7XG4gICAgfVxuICAgIHRoaXMuX3Byb2Nlc3NMaWtlcygpO1xuXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5nYWxsZXJ5X190aXRsZScpLnRleHRDb250ZW50ID0gdGhpcy5nZXROYW1lKCk7XG4gICAgdGhpcy5faW1hZ2VFbGVtZW50LmFsdCA9IHRoaXMuZ2V0TmFtZSgpO1xuICAgIHRoaXMuX2ltYWdlRWxlbWVudC5zcmMgPSB0aGlzLmdldExpbmsoKTtcblxuICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcbiAgY29uc3RydWN0b3IocGFyYW1zLCBmb3JtKSB7XG4gICAgdGhpcy5fZm9ybSA9IGZvcm07XG4gICAgdGhpcy5fcGFyYW1zID0gcGFyYW1zO1xuXG4gICAgdGhpcy5faW5wdXRzID0gQXJyYXkuZnJvbShmb3JtLnF1ZXJ5U2VsZWN0b3JBbGwocGFyYW1zLmlucHV0U2VsZWN0b3IpKTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSBmb3JtLnF1ZXJ5U2VsZWN0b3IocGFyYW1zLnN1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcbiAgfVxuXG4gIF9oYXNJbnZhbGlkSW5wdXQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2lucHV0cy5zb21lKChpbnB1dCkgPT4gIWlucHV0LnZhbGlkaXR5LnZhbGlkKTtcbiAgfVxuXG4gIF9kaXNhYmxlU3VibWl0QnV0dG9uID0gKCkgPT4ge1xuICAgIGNvbnN0IHsgaW5hY3RpdmVCdXR0b25DbGFzcyB9ID0gdGhpcy5fcGFyYW1zO1xuXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQoaW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLnNldEF0dHJpYnV0ZSgnZGlzYWJsZWQnLCB0cnVlKTtcbiAgfTtcblxuICBfZW5hYmxlU3VibWl0QnV0dG9uID0gKCkgPT4ge1xuICAgIGNvbnN0IHsgaW5hY3RpdmVCdXR0b25DbGFzcyB9ID0gdGhpcy5fcGFyYW1zO1xuXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoaW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLnJlbW92ZUF0dHJpYnV0ZSgnZGlzYWJsZWQnKTtcbiAgfTtcblxuICBfdG9nZ2xlU3VibWl0QnV0dG9uKCkge1xuICAgIGlmICh0aGlzLl9oYXNJbnZhbGlkSW5wdXQoKSkge1xuICAgICAgdGhpcy5fZGlzYWJsZVN1Ym1pdEJ1dHRvbigpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9lbmFibGVTdWJtaXRCdXR0b24oKTtcbiAgICB9XG4gIH1cblxuICBfZ2V0RXJyb3JFbGVtZW50KGlucHV0KSB7XG4gICAgcmV0dXJuIHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihgLiR7aW5wdXQubmFtZX0taW5wdXQtZXJyb3JgKTtcbiAgfVxuXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dCkge1xuICAgIGNvbnN0IHsgaW5wdXRFcnJvckNsYXNzLCBlcnJvckNsYXNzIH0gPSB0aGlzLl9wYXJhbXM7XG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZ2V0RXJyb3JFbGVtZW50KGlucHV0KTtcbiAgICBpbnB1dC5jbGFzc0xpc3QuYWRkKGlucHV0RXJyb3JDbGFzcyk7XG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gaW5wdXQudmFsaWRhdGlvbk1lc3NhZ2U7XG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQoZXJyb3JDbGFzcyk7XG4gIH1cblxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXQpIHtcbiAgICBjb25zdCB7IGlucHV0RXJyb3JDbGFzcywgZXJyb3JDbGFzcyB9ID0gdGhpcy5fcGFyYW1zO1xuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2dldEVycm9yRWxlbWVudChpbnB1dCk7XG4gICAgaW5wdXQuY2xhc3NMaXN0LnJlbW92ZShpbnB1dEVycm9yQ2xhc3MpO1xuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKGVycm9yQ2xhc3MpO1xuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9ICcnO1xuICB9XG5cbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dCkge1xuICAgIGlmICghaW5wdXQudmFsaWRpdHkudmFsaWQpIHtcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXQpO1xuICAgIH1cbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9pbnB1dHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgKCkgPT4ge1xuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXQpO1xuICAgICAgICB0aGlzLl90b2dnbGVTdWJtaXRCdXR0b24oKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgcmVzZXRWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuX2lucHV0cy5mb3JFYWNoKChpbnB1dCkgPT4gdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXQpKTtcbiAgICB0aGlzLl90b2dnbGVTdWJtaXRCdXR0b24oKTtcbiAgfVxuXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCAoZXZlbnQpID0+IGV2ZW50LnByZXZlbnREZWZhdWx0KCkpO1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIHtcbiAgY29uc3RydWN0b3Ioc2VsZWN0b3IpIHtcbiAgICB0aGlzLl9lbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzZWxlY3Rvcik7XG4gIH1cblxuICBfaGFuZGxlRXNjQ2xvc2UgPSAoZXZlbnQpID0+IHtcbiAgICBpZiAoZXZlbnQua2V5ID09PSAnRXNjYXBlJykge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfVxuXG4gIF9oYW5kbGVDbG9zZSA9IChldmVudCkgPT4ge1xuICAgIGlmIChcbiAgICAgIGV2ZW50LnRhcmdldCA9PT0gZXZlbnQuY3VycmVudFRhcmdldCB8fFxuICAgICAgZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnYnV0dG9uX3R5cGVfY2xvc2UnKVxuICAgICkge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2VsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLl9oYW5kbGVDbG9zZSk7XG4gIH1cblxuICBvcGVuKCkge1xuICAgIHRoaXMuX2VsZW1lbnQuY2xhc3NMaXN0LmFkZCgncG9wdXBfb3BlbmVkJyk7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICB0aGlzLl9lbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ3BvcHVwX29wZW5lZCcpO1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleXVwJywgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICB9XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSAnLi9Qb3B1cC5qcyc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3RvcihzZWxlY3Rvcikge1xuICAgIHN1cGVyKHNlbGVjdG9yKTtcbiAgICB0aGlzLl9pbWFnZSA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLnByZXZpZXdfX2ltYWdlJyk7XG4gICAgdGhpcy5fdGl0bGUgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcmV2aWV3X190aXRsZScpO1xuICB9XG5cbiAgb3BlbihjYXJkKSB7XG4gICAgY29uc3QgbmFtZSA9IGNhcmQuZ2V0TmFtZSgpO1xuICAgIHRoaXMuX3RpdGxlLnRleHRDb250ZW50ID0gbmFtZTtcbiAgICB0aGlzLl9pbWFnZS5hbHQgPSBuYW1lO1xuICAgIHRoaXMuX2ltYWdlLnNyYyA9IGNhcmQuZ2V0TGluaygpO1xuICAgIHN1cGVyLm9wZW4oKTtcbiAgfVxufVxuIiwiaW1wb3J0IFBvcHVwIGZyb20gJy4vUG9wdXAuanMnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3RvcihzZWxlY3Rvciwgc3VibWl0KSB7XG4gICAgc3VwZXIoc2VsZWN0b3IpO1xuICAgIHRoaXMuX3N1Ym1pdCA9IHN1Ym1pdDtcbiAgICB0aGlzLl9mb3JtID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2Zvcm0nKTtcbiAgICB0aGlzLl9pbnB1dHMgPSBBcnJheS5mcm9tKHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbCgnLnBvcHVwX19pbnB1dCcpKTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5idXR0b25fdHlwZV9zYXZlJyk7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uQ2FwdGlvbiA9IHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudDtcbiAgfVxuXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcbiAgICAvKiBlc2xpbnQgdW5pY29ybi9wcmVmZXItb2JqZWN0LWZyb20tZW50cmllczogXCJvZmZcIiAqL1xuICAgIHJldHVybiB0aGlzLl9pbnB1dHMucmVkdWNlKChyZXN1bHQsIHsgbmFtZSwgdmFsdWUgfSkgPT4ge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgLi4ucmVzdWx0LFxuICAgICAgICBbbmFtZV06IHZhbHVlLFxuICAgICAgfTtcbiAgICB9LCB7fSk7XG4gIH1cblxuICByZW5kZXJMb2FkaW5nKGlzTG9hZGluZykge1xuICAgIGlmIChpc0xvYWRpbmcpIHtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9ICfQodC+0YXRgNCw0L3QtdC90LjQtS4uLic7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IHRoaXMuX3N1Ym1pdEJ1dHRvbkNhcHRpb247XG4gICAgfVxuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIChldmVudCkgPT4ge1xuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHRoaXMuX3N1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcbiAgICB9KTtcbiAgfVxuXG4gIGNsb3NlKCkge1xuICAgIHN1cGVyLmNsb3NlKCk7XG4gICAgdGhpcy5fZm9ybS5yZXNldCgpO1xuICB9XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSAnLi9Qb3B1cC5qcyc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIGV4dGVuZHMgUG9wdXAge1xuICBzZXRBY3Rpb24oZnVuYykge1xuICAgIHRoaXMuX2FjdGlvbiA9IGZ1bmM7XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuX2VsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgKGV2ZW50KSA9PiB7XG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5fYWN0aW9uKCk7XG4gICAgfSk7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIHtcbiAgY29uc3RydWN0b3IoeyBuYW1lU2VsZWN0b3IsIGRlc2NyaXB0aW9uU2VsZWN0b3IsIGF2YXRhclNlbGVjdG9yIH0pIHtcbiAgICB0aGlzLl9pZCA9IG51bGw7XG4gICAgdGhpcy5fbmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmFtZVNlbGVjdG9yKTtcbiAgICB0aGlzLl9kZXNjcmlwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZGVzY3JpcHRpb25TZWxlY3Rvcik7XG4gICAgdGhpcy5fYXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihhdmF0YXJTZWxlY3Rvcik7XG4gIH1cblxuICBnZXRVc2VySW5mbygpIHtcbiAgICByZXR1cm4ge1xuICAgICAgbmFtZTogdGhpcy5fbmFtZS50ZXh0Q29udGVudCxcbiAgICAgIGRlc2NyaXB0aW9uOiB0aGlzLl9kZXNjcmlwdGlvbi50ZXh0Q29udGVudCxcbiAgICB9O1xuICB9XG5cbiAgc2V0VXNlckluZm8oeyBuYW1lLCBhYm91dCwgYXZhdGFyLCBfaWQgfSkge1xuICAgIHRoaXMuX2lkID0gX2lkO1xuICAgIHRoaXMuX25hbWUudGV4dENvbnRlbnQgPSBuYW1lO1xuICAgIHRoaXMuX2Rlc2NyaXB0aW9uLnRleHRDb250ZW50ID0gYWJvdXQ7XG4gICAgdGhpcy5fYXZhdGFyLnN0eWxlLmJhY2tncm91bmRJbWFnZSA9IGB1cmwoJHthdmF0YXJ9KWA7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIHtcbiAgY29uc3RydWN0b3IoeyBkYXRhLCByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xuICAgIHRoaXMuX3JlbmRlcmVkSXRlbXMgPSBkYXRhO1xuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJTZWxlY3Rvcik7XG4gIH1cblxuICBhZGRJdGVtKGVsZW1lbnQsIGZpcnN0ID0gdHJ1ZSkge1xuICAgIGlmIChmaXJzdCkge1xuICAgICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoZWxlbWVudCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2NvbnRhaW5lci5hcHBlbmQoZWxlbWVudCk7XG4gICAgfVxuICB9XG5cbiAgcmVuZGVySXRlbXMoKSB7XG4gICAgdGhpcy5fcmVuZGVyZWRJdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICB0aGlzLl9yZW5kZXJlcihpdGVtKTtcbiAgICB9KTtcbiAgfVxufVxuIiwiZXhwb3J0IGNvbnN0IGdhbGxlcnlTZWxlY3RvciA9ICcuZ2FsbGVyeSc7XG5cbmV4cG9ydCBjb25zdCBhZGRDYXJkRm9ybSA9IGRvY3VtZW50LmZvcm1zLmFkZENhcmQ7XG5leHBvcnQgY29uc3QgdXNlclByb2ZpbGVGb3JtID0gZG9jdW1lbnQuZm9ybXMudXNlclByb2ZpbGU7XG5leHBvcnQgY29uc3QgbmFtZUlucHV0ID0gdXNlclByb2ZpbGVGb3JtLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW5wdXRfcHJvcGVydHlfbmFtZScpO1xuZXhwb3J0IGNvbnN0IGRlc2NyaXB0aW9uSW5wdXQgPSB1c2VyUHJvZmlsZUZvcm0ucXVlcnlTZWxlY3RvcignLnBvcHVwX19pbnB1dF9wcm9wZXJ0eV9kZXNjcmlwdGlvbicpO1xuXG5leHBvcnQgY29uc3QgZWRpdFByb2ZpbGVCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnV0dG9uX3R5cGVfZWRpdCcpO1xuZXhwb3J0IGNvbnN0IGFkZENhcmRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnV0dG9uX3R5cGVfYWRkJyk7XG5leHBvcnQgY29uc3QgYXZhdGFyQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2F2YXRhcicpO1xuXG5leHBvcnQgY29uc3QgdmFsaWRhdGlvbkNvbmZpZyA9IHtcbiAgZm9ybVNlbGVjdG9yOiAnLnBvcHVwX19mb3JtJyxcbiAgaW5wdXRTZWxlY3RvcjogJy5wb3B1cF9faW5wdXQnLFxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogJy5idXR0b24nLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiAnYnV0dG9uX2Rpc2FibGVkJyxcbiAgaW5wdXRFcnJvckNsYXNzOiAncG9wdXBfX2lucHV0X3R5cGVfZXJyb3InLFxuICBlcnJvckNsYXNzOiAncG9wdXBfX2Vycm9yX3Zpc2libGUnLFxufTtcbiIsImV4cG9ydCBjb25zdCBlcnJvckhhbmRsZXIgPSAoZXJyb3IpID0+IHtcbiAgY29uc29sZS5sb2coZXJyb3IpO1xufTtcbiIsImltcG9ydCAnLi9pbmRleC5jc3MnO1xuXG5pbXBvcnQgQXBpIGZyb20gJy4uL2NvbXBvbmVudHMvQXBpLmpzJztcbmltcG9ydCBDYXJkIGZyb20gJy4uL2NvbXBvbmVudHMvQ2FyZC5qcyc7XG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tICcuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMnO1xuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gJy4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMnO1xuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSAnLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzJztcbmltcG9ydCBQb3B1cFdpdGhTdWJtaXQgZnJvbSAnLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhTdWJtaXQuanMnO1xuaW1wb3J0IFVzZXJJbmZvIGZyb20gJy4uL2NvbXBvbmVudHMvVXNlckluZm8uanMnO1xuaW1wb3J0IFNlY3Rpb24gZnJvbSAnLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzJztcbmltcG9ydCB7XG4gIGdhbGxlcnlTZWxlY3RvcixcbiAgYWRkQ2FyZEZvcm0sXG4gIHVzZXJQcm9maWxlRm9ybSxcbiAgbmFtZUlucHV0LFxuICBkZXNjcmlwdGlvbklucHV0LFxuICBlZGl0UHJvZmlsZUJ1dHRvbixcbiAgYWRkQ2FyZEJ1dHRvbixcbiAgdmFsaWRhdGlvbkNvbmZpZyxcbiAgYXZhdGFyQnV0dG9uLFxufSBmcm9tICcuLi91dGlscy9jb25zdGFudHMuanMnO1xuaW1wb3J0IHsgZXJyb3JIYW5kbGVyIH0gZnJvbSAnLi4vdXRpbHMvaGVscGVycy5qcyc7XG5cbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xuICBiYXNlVXJsOiAnaHR0cHM6Ly9tZXN0by5ub21vcmVwYXJ0aWVzLmNvL3YxL2NvaG9ydC00MScsXG4gIGhlYWRlcnM6IHtcbiAgICBhdXRob3JpemF0aW9uOiAnNGUwYWNmZTktZDcxYi00MzU4LTkxYWYtYzhmZDk2MzQ0MmY1JyxcbiAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICB9LFxufSk7XG5cbmNvbnN0IGZvcm1WYWxpZGF0b3JzID0ge307XG5jb25zdCBlbmFibGVWYWxpZGF0aW9uID0gKHsgZm9ybVNlbGVjdG9yLCAuLi5wYXJhbXMgfSkgPT4ge1xuICBjb25zdCBmb3JtTGlzdCA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChmb3JtU2VsZWN0b3IpKTtcbiAgZm9ybUxpc3QuZm9yRWFjaCgoZm9ybSkgPT4ge1xuICAgIGNvbnN0IHZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHBhcmFtcywgZm9ybSk7XG4gICAgdmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcbiAgICBmb3JtVmFsaWRhdG9yc1tmb3JtLmdldEF0dHJpYnV0ZSgnbmFtZScpXSA9IHZhbGlkYXRvcjtcbiAgfSk7XG59O1xuZW5hYmxlVmFsaWRhdGlvbih2YWxpZGF0aW9uQ29uZmlnKTtcblxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oe1xuICBuYW1lU2VsZWN0b3I6ICcucHJvZmlsZV9fdGl0bGUnLFxuICBkZXNjcmlwdGlvblNlbGVjdG9yOiAnLnByb2ZpbGVfX2Rlc2NyaXB0aW9uJyxcbiAgYXZhdGFyU2VsZWN0b3I6ICcucHJvZmlsZV9fYXZhdGFyJyxcbn0pO1xuXG5jb25zdCBwcmV2aWV3UG9wdXAgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoJy5wb3B1cF90eXBlX3ByZXZpZXcnKTtcbmNvbnN0IGNvbmZpcm1Qb3B1cCA9IG5ldyBQb3B1cFdpdGhTdWJtaXQoJy5wb3B1cF90eXBlX2NvbmZpcm0nKTtcblxuY29uc3QgY3JlYXRlQ2FyZCA9IChkYXRhKSA9PiB7XG4gIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChcbiAgICB7XG4gICAgICBkYXRhOiB7XG4gICAgICAgIGN1cnJlbnRVc2VySWQ6IHVzZXJJbmZvLl9pZCxcbiAgICAgICAgLi4uZGF0YSxcbiAgICAgIH0sXG4gICAgICBoYW5kbGVDYXJkQ2xpY2s6ICgpID0+IHtcbiAgICAgICAgcHJldmlld1BvcHVwLm9wZW4oY2FyZCk7XG4gICAgICB9LFxuICAgICAgaGFuZGxlTGlrZUNsaWNrOiAoY2FyZE9iamVjdCkgPT4ge1xuICAgICAgICBjb25zdCBtZXRob2QgPSBjYXJkT2JqZWN0LmlzTGlrZWQoKVxuICAgICAgICAgID8gYXBpLnJlbW92ZUxpa2UoY2FyZE9iamVjdC5nZXRJZCgpKVxuICAgICAgICAgIDogYXBpLmxpa2VDYXJkKGNhcmRPYmplY3QuZ2V0SWQoKSk7XG4gICAgICAgIG1ldGhvZFxuICAgICAgICAgIC50aGVuKChkYXRhKSA9PiB7XG4gICAgICAgICAgICBjYXJkT2JqZWN0LnVwZGF0ZUxpa2VzKGRhdGEpO1xuICAgICAgICAgIH0pXG4gICAgICAgICAgLmNhdGNoKGVycm9ySGFuZGxlcik7XG4gICAgICB9LFxuICAgICAgaGFuZGxlRGVsZXRlQ2xpY2s6IChjYXJkT2JqZWN0KSA9PiB7XG4gICAgICAgIGNvbmZpcm1Qb3B1cC5vcGVuKCk7XG4gICAgICAgIGNvbmZpcm1Qb3B1cC5zZXRBY3Rpb24oKCkgPT4ge1xuICAgICAgICAgIGFwaVxuICAgICAgICAgICAgLmRlbGV0ZUNhcmQoY2FyZE9iamVjdC5nZXRJZCgpKVxuICAgICAgICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgICBjYXJkT2JqZWN0LnJlbW92ZSgpO1xuICAgICAgICAgICAgICBjb25maXJtUG9wdXAuY2xvc2UoKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuY2F0Y2goZXJyb3JIYW5kbGVyKTtcbiAgICAgICAgfSk7XG4gICAgICB9LFxuICAgIH0sXG4gICAgJyNnYWxsZXJ5LWl0ZW0tdGVtcGxhdGUnXG4gICk7XG4gIHJldHVybiBjYXJkLmdlbmVyYXRlQ2FyZCgpO1xufTtcblxuY29uc3QgZGVmYXVsdENhcmRMaXN0ID0gbmV3IFNlY3Rpb24oXG4gIHtcbiAgICBkYXRhOiBbXSxcbiAgICByZW5kZXJlcjogKGl0ZW0pID0+IHtcbiAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gY3JlYXRlQ2FyZChpdGVtKTtcbiAgICAgIGRlZmF1bHRDYXJkTGlzdC5hZGRJdGVtKGNhcmRFbGVtZW50KTtcbiAgICB9LFxuICB9LFxuICBnYWxsZXJ5U2VsZWN0b3Jcbik7XG5cbmFwaVxuICAuZ2V0SW5pdGlhbERhdGEoKVxuICAudGhlbigoW3VzZXJEYXRhLCBjYXJkc10pID0+IHtcbiAgICB1c2VySW5mby5zZXRVc2VySW5mbyh1c2VyRGF0YSk7XG5cbiAgICBjYXJkcy5mb3JFYWNoKChjYXJkKSA9PiB7XG4gICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGNyZWF0ZUNhcmQoY2FyZCk7XG4gICAgICBkZWZhdWx0Q2FyZExpc3QuYWRkSXRlbShjYXJkRWxlbWVudCwgZmFsc2UpO1xuICAgIH0pO1xuICB9KVxuICAuY2F0Y2goZXJyb3JIYW5kbGVyKTtcblxuY29uc3QgY2FyZFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oJy5wb3B1cF90eXBlX2FkZC1jYXJkJywgKGlucHV0VmFsdWVzKSA9PiB7XG4gIGNhcmRQb3B1cC5yZW5kZXJMb2FkaW5nKHRydWUpO1xuICBhcGlcbiAgICAuYWRkQ2FyZChpbnB1dFZhbHVlcylcbiAgICAudGhlbigoZGF0YSkgPT4ge1xuICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBjcmVhdGVDYXJkKGRhdGEpO1xuICAgICAgZGVmYXVsdENhcmRMaXN0LmFkZEl0ZW0oY2FyZEVsZW1lbnQpO1xuICAgICAgY2FyZFBvcHVwLmNsb3NlKCk7XG4gICAgfSlcbiAgICAuY2F0Y2goZXJyb3JIYW5kbGVyKVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIGNhcmRQb3B1cC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcbiAgICB9KTtcbn0pO1xuY29uc3QgcHJvZmlsZVBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oJy5wb3B1cF90eXBlX2VkaXQtcHJvZmlsZScsIChpbnB1dFZhbHVlcykgPT4ge1xuICBwcm9maWxlUG9wdXAucmVuZGVyTG9hZGluZyh0cnVlKTtcbiAgYXBpXG4gICAgLnVwZGF0ZVVzZXJJbmZvKGlucHV0VmFsdWVzKVxuICAgIC50aGVuKChkYXRhKSA9PiB7XG4gICAgICB1c2VySW5mby5zZXRVc2VySW5mbyhkYXRhKTtcbiAgICAgIHByb2ZpbGVQb3B1cC5jbG9zZSgpO1xuICAgIH0pXG4gICAgLmNhdGNoKGVycm9ySGFuZGxlcilcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICBwcm9maWxlUG9wdXAucmVuZGVyTG9hZGluZyhmYWxzZSk7XG4gICAgfSk7XG59KTtcbmNvbnN0IGF2YXRhclBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oJy5wb3B1cF90eXBlX2F2YXRhcicsIChpbnB1dFZhbHVlcykgPT4ge1xuICBhdmF0YXJQb3B1cC5yZW5kZXJMb2FkaW5nKHRydWUpO1xuICBhcGlcbiAgICAudXBkYXRlQXZhdGFyKGlucHV0VmFsdWVzKVxuICAgIC50aGVuKChkYXRhKSA9PiB7XG4gICAgICB1c2VySW5mby5zZXRVc2VySW5mbyhkYXRhKTtcbiAgICAgIGF2YXRhclBvcHVwLmNsb3NlKCk7XG4gICAgfSlcbiAgICAuY2F0Y2goZXJyb3JIYW5kbGVyKVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIGF2YXRhclBvcHVwLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xuICAgIH0pO1xufSk7XG5bcHJldmlld1BvcHVwLCBjYXJkUG9wdXAsIHByb2ZpbGVQb3B1cCwgY29uZmlybVBvcHVwLCBhdmF0YXJQb3B1cF0uZm9yRWFjaCgocG9wdXApID0+XG4gIHBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKClcbik7XG5cbmF2YXRhckJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgYXZhdGFyUG9wdXAub3BlbigpO1xufSk7XG5hZGRDYXJkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICBmb3JtVmFsaWRhdG9yc1thZGRDYXJkRm9ybS5nZXRBdHRyaWJ1dGUoJ25hbWUnKV0ucmVzZXRWYWxpZGF0aW9uKCk7XG4gIGNhcmRQb3B1cC5vcGVuKCk7XG59KTtcbmVkaXRQcm9maWxlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICBjb25zdCB7IG5hbWUsIGRlc2NyaXB0aW9uIH0gPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xuICBuYW1lSW5wdXQudmFsdWUgPSBuYW1lO1xuICBkZXNjcmlwdGlvbklucHV0LnZhbHVlID0gZGVzY3JpcHRpb247XG4gIGZvcm1WYWxpZGF0b3JzW3VzZXJQcm9maWxlRm9ybS5nZXRBdHRyaWJ1dGUoJ25hbWUnKV0ucmVzZXRWYWxpZGF0aW9uKCk7XG4gIHByb2ZpbGVQb3B1cC5vcGVuKCk7XG59KTtcbiJdLCJuYW1lcyI6WyJiYXNlVXJsIiwiaGVhZGVycyIsInRoaXMiLCJfYmFzZVVybCIsIl9oZWFkZXJzIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsInBhdGgiLCJmZXRjaCIsInRoZW4iLCJfcHJvY2Vzc1Jlc3BvbnNlIiwiX2dldCIsImFsbCIsIl9nZXRVc2VySW5mbyIsIl9nZXRJbml0aWFsQ2FyZHMiLCJuYW1lIiwiZGVzY3JpcHRpb24iLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImFib3V0IiwiY2FyZCIsImNhcmRJZCIsImRhdGEiLCJ0ZW1wbGF0ZVNlbGVjdG9yIiwiaGFuZGxlQ2FyZENsaWNrIiwiaGFuZGxlTGlrZUNsaWNrIiwiaGFuZGxlRGVsZXRlQ2xpY2siLCJfZWxlbWVudCIsInJlbW92ZSIsIl9jYXJkRGF0YSIsIl90ZW1wbGF0ZVNlbGVjdG9yIiwiX2hhbmRsZUNhcmRDbGljayIsIl9oYW5kbGVMaWtlQ2xpY2siLCJfaGFuZGxlRGVsZXRlQ2xpY2siLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiX2ltYWdlRWxlbWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJfZGVsZXRlQnV0dG9uIiwibGluayIsIl9pZCIsImxpa2VzIiwic29tZSIsInVzZXIiLCJjdXJyZW50VXNlcklkIiwiX3Byb2Nlc3NMaWtlcyIsImlzTGlrZWQiLCJfbGlrZUJ1dHRvbiIsImNsYXNzTGlzdCIsImFkZCIsIl9saWtlQ291bnRlciIsInRleHRDb250ZW50IiwibGVuZ3RoIiwiX2dldFRlbXBsYXRlIiwib3duZXIiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJnZXROYW1lIiwiYWx0Iiwic3JjIiwiZ2V0TGluayIsIkZvcm1WYWxpZGF0b3IiLCJwYXJhbXMiLCJmb3JtIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9wYXJhbXMiLCJfc3VibWl0QnV0dG9uIiwic2V0QXR0cmlidXRlIiwicmVtb3ZlQXR0cmlidXRlIiwiX2Zvcm0iLCJfaW5wdXRzIiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsImlucHV0U2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImlucHV0IiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9oYXNJbnZhbGlkSW5wdXQiLCJfZGlzYWJsZVN1Ym1pdEJ1dHRvbiIsIl9lbmFibGVTdWJtaXRCdXR0b24iLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiZXJyb3JFbGVtZW50IiwiX2dldEVycm9yRWxlbWVudCIsInZhbGlkYXRpb25NZXNzYWdlIiwiX2hpZGVJbnB1dEVycm9yIiwiX3Nob3dJbnB1dEVycm9yIiwiZm9yRWFjaCIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJfdG9nZ2xlU3VibWl0QnV0dG9uIiwiZXZlbnQiLCJwcmV2ZW50RGVmYXVsdCIsInNlbGVjdG9yIiwia2V5IiwiY2xvc2UiLCJ0YXJnZXQiLCJjdXJyZW50VGFyZ2V0IiwiY29udGFpbnMiLCJfaGFuZGxlQ2xvc2UiLCJfaGFuZGxlRXNjQ2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiUG9wdXBXaXRoSW1hZ2UiLCJfaW1hZ2UiLCJfdGl0bGUiLCJQb3B1cCIsIlBvcHVwV2l0aEZvcm0iLCJzdWJtaXQiLCJfc3VibWl0IiwiX3N1Ym1pdEJ1dHRvbkNhcHRpb24iLCJyZWR1Y2UiLCJyZXN1bHQiLCJ2YWx1ZSIsImlzTG9hZGluZyIsIl9nZXRJbnB1dFZhbHVlcyIsInJlc2V0IiwiZnVuYyIsIl9hY3Rpb24iLCJuYW1lU2VsZWN0b3IiLCJkZXNjcmlwdGlvblNlbGVjdG9yIiwiYXZhdGFyU2VsZWN0b3IiLCJfbmFtZSIsIl9kZXNjcmlwdGlvbiIsIl9hdmF0YXIiLCJhdmF0YXIiLCJzdHlsZSIsImJhY2tncm91bmRJbWFnZSIsImNvbnRhaW5lclNlbGVjdG9yIiwicmVuZGVyZXIiLCJfcmVuZGVyZWRJdGVtcyIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJlbGVtZW50IiwiZmlyc3QiLCJwcmVwZW5kIiwiYXBwZW5kIiwiaXRlbSIsImFkZENhcmRGb3JtIiwiZm9ybXMiLCJhZGRDYXJkIiwidXNlclByb2ZpbGVGb3JtIiwidXNlclByb2ZpbGUiLCJuYW1lSW5wdXQiLCJkZXNjcmlwdGlvbklucHV0IiwiZWRpdFByb2ZpbGVCdXR0b24iLCJhZGRDYXJkQnV0dG9uIiwiYXZhdGFyQnV0dG9uIiwiZXJyb3JIYW5kbGVyIiwiZXJyb3IiLCJjb25zb2xlIiwibG9nIiwiZm9ybVNlbGVjdG9yIiwiYXBpIiwiQXBpIiwiYXV0aG9yaXphdGlvbiIsImZvcm1WYWxpZGF0b3JzIiwidmFsaWRhdG9yIiwiZW5hYmxlVmFsaWRhdGlvbiIsImdldEF0dHJpYnV0ZSIsInVzZXJJbmZvIiwiVXNlckluZm8iLCJwcmV2aWV3UG9wdXAiLCJjb25maXJtUG9wdXAiLCJQb3B1cFdpdGhTdWJtaXQiLCJjcmVhdGVDYXJkIiwiQ2FyZCIsIm9wZW4iLCJjYXJkT2JqZWN0IiwicmVtb3ZlTGlrZSIsImdldElkIiwibGlrZUNhcmQiLCJ1cGRhdGVMaWtlcyIsImNhdGNoIiwic2V0QWN0aW9uIiwiZGVsZXRlQ2FyZCIsImdlbmVyYXRlQ2FyZCIsImRlZmF1bHRDYXJkTGlzdCIsIlNlY3Rpb24iLCJjYXJkRWxlbWVudCIsImFkZEl0ZW0iLCJnZXRJbml0aWFsRGF0YSIsInVzZXJEYXRhIiwiY2FyZHMiLCJzZXRVc2VySW5mbyIsImNhcmRQb3B1cCIsImlucHV0VmFsdWVzIiwicmVuZGVyTG9hZGluZyIsImZpbmFsbHkiLCJwcm9maWxlUG9wdXAiLCJ1cGRhdGVVc2VySW5mbyIsImF2YXRhclBvcHVwIiwidXBkYXRlQXZhdGFyIiwicG9wdXAiLCJzZXRFdmVudExpc3RlbmVycyIsInJlc2V0VmFsaWRhdGlvbiIsImdldFVzZXJJbmZvIl0sInNvdXJjZVJvb3QiOiIifQ==